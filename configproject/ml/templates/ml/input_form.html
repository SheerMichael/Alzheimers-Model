{% extends 'base.html' %}

{% block title %}Input Patient Data - Alzheimer's Prediction{% endblock %}

{% block extra_css %}
<style>
    .form-group { margin-bottom: 1rem; }
    .form-check { margin-bottom: 0.5rem; }
    .alert-info { background-color: #d1ecf1; border-color: #bee5eb; }
    .field-help { font-size: 0.8rem; color: #6c757d; margin-top: 0.25rem; }
    .required-indicator { color: red; }
</style>
{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-md-10">
    <h2 class="mb-4">Alzheimer's Disease Risk Assessment</h2>
    <div class="alert alert-info" role="alert">
      <p><strong>Important:</strong> This tool provides an estimate of Alzheimer's disease risk based on patient data. It is not a diagnostic tool and should be used only as part of a comprehensive clinical assessment.</p>
      <p class="mb-0">Fields marked with <span class="required-indicator">*</span> are required.</p>
    </div>

    <form method="post" novalidate>
      {% csrf_token %}

      <!-- Basic Information -->
      <div class="card mb-4">
        <div class="card-header bg-light">
          <h3 class="h5 mb-0">Basic Information</h3>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-4 form-group">
              <label for="{{ form.age.id_for_label }}">Age <span class="required-indicator">*</span></label>
              <input type="number" name="{{ form.age.html_name }}" id="{{ form.age.id_for_label }}" class="form-control {% if form.age.errors %}is-invalid{% endif %}" value="{{ form.age.value|default:'' }}" min="0" max="120" required>
              {% for err in form.age.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
            <div class="col-md-4 form-group">
              <label for="{{ form.gender.id_for_label }}">Gender <span class="required-indicator">*</span></label>
              <select name="{{ form.gender.html_name }}" id="{{ form.gender.id_for_label }}" class="form-select {% if form.gender.errors %}is-invalid{% endif %}" required>
                <option value="">Select</option>
                {% for val, text in form.fields.gender.choices %}
                  <option value="{{ val }}" {% if form.gender.value == val %}selected{% endif %}>{{ text }}</option>
                {% endfor %}
              </select>
              {% for err in form.gender.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
            <div class="col-md-4 form-group">
              <label for="{{ form.education_level.id_for_label }}">Education Level (yrs) <span class="required-indicator">*</span></label>
              <input type="number" name="{{ form.education_level.html_name }}" id="{{ form.education_level.id_for_label }}" class="form-control {% if form.education_level.errors %}is-invalid{% endif %}" value="{{ form.education_level.value|default:'' }}" min="0" max="30" required>
              {% for err in form.education_level.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
              <div class="field-help">Total years of formal education completed.</div>
            </div>
          </div>
          <div class="row mt-3">
            <div class="col-md-4 form-group">
              <label for="{{ form.bmi.id_for_label }}">BMI <span class="required-indicator">*</span></label>
              <input type="number" name="{{ form.bmi.html_name }}" id="{{ form.bmi.id_for_label }}" class="form-control {% if form.bmi.errors %}is-invalid{% endif %}" value="{{ form.bmi.value|default:'' }}" step="0.1" min="10" max="50" required>
              {% for err in form.bmi.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
          </div>
        </div>
      </div>

      <!-- Lifestyle Factors -->
      <div class="card mb-4">
        <div class="card-header bg-light">
          <h3 class="h5 mb-0">Lifestyle Factors</h3>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-3 form-check">
              <input type="checkbox" name="{{ form.smoking.html_name }}" id="{{ form.smoking.id_for_label }}" class="form-check-input {% if form.smoking.errors %}is-invalid{% endif %}" {% if form.smoking.value %}checked{% endif %}>
              <label class="form-check-label" for="{{ form.smoking.id_for_label }}">Smoking</label>
              {% for err in form.smoking.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
            <div class="col-md-3 form-group">
              <label for="{{ form.alcohol_consumption.id_for_label }}">Alcohol Consumption</label>
              <select name="{{ form.alcohol_consumption.html_name }}" id="{{ form.alcohol_consumption.id_for_label }}" class="form-select {% if form.alcohol_consumption.errors %}is-invalid{% endif %}">
                <option value="">Select</option>
                <option value="None" {% if form.alcohol_consumption.value == 'None' %}selected{% endif %}>None</option>
                <option value="Occasional" {% if form.alcohol_consumption.value == 'Occasional' %}selected{% endif %}>Occasional</option>
                <option value="Moderate" {% if form.alcohol_consumption.value == 'Moderate' %}selected{% endif %}>Moderate</option> 
                <option value="Heavy" {% if form.alcohol_consumption.value == 'Heavy' %}selected{% endif %}>Heavy</option>
              </select>
              {% for err in form.alcohol_consumption.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
            <div class="col-md-3 form-group">
              <label for="{{ form.physical_activity.id_for_label }}">Physical Activity</label>
              <select name="{{ form.physical_activity.html_name }}" id="{{ form.physical_activity.id_for_label }}" class="form-select {% if form.physical_activity.errors %}is-invalid{% endif %}">
                <option value="">Select</option>
                <option value="Low" {% if form.physical_activity.value == 'Low' %}selected{% endif %}>Low</option>
                <option value="Moderate" {% if form.physical_activity.value == 'Moderate' %}selected{% endif %}>Moderate</option>
                <option value="High" {% if form.physical_activity.value == 'High' %}selected{% endif %}>High</option>
              </select>
              {% for err in form.physical_activity.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
            <div class="col-md-3 form-group">
              <label for="{{ form.diet_quality.id_for_label }}">Diet Quality</label>
              <select name="{{ form.diet_quality.html_name }}" id="{{ form.diet_quality.id_for_label }}" class="form-select {% if form.diet_quality.errors %}is-invalid{% endif %}">
                <option value="">Select</option>
                <option value="Poor" {% if form.diet_quality.value == 'Poor' %}selected{% endif %}>Poor</option>
                <option value="Fair" {% if form.diet_quality.value == 'Fair' %}selected{% endif %}>Fair</option>
                <option value="Good" {% if form.diet_quality.value == 'Good' %}selected{% endif %}>Good</option>
                <option value="Excellent" {% if form.diet_quality.value == 'Excellent' %}selected{% endif %}>Excellent</option>
              </select>
              {% for err in form.diet_quality.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
          </div>
          <div class="row mt-3">
            <div class="col-md-3 form-group">
              <label for="{{ form.sleep_quality.id_for_label }}">Sleep Quality</label>
              <select name="{{ form.sleep_quality.html_name }}" id="{{ form.sleep_quality.id_for_label }}" class="form-select {% if form.sleep_quality.errors %}is-invalid{% endif %}">
                <option value="">Select</option>
                <option value="Poor" {% if form.sleep_quality.value == 'Poor' %}selected{% endif %}>Poor</option>
                <option value="Fair" {% if form.sleep_quality.value == 'Fair' %}selected{% endif %}>Fair</option>
                <option value="Good" {% if form.sleep_quality.value == 'Good' %}selected{% endif %}>Good</option>
                <option value="Excellent" {% if form.sleep_quality.value == 'Excellent' %}selected{% endif %}>Excellent</option>
              </select>
              {% for err in form.sleep_quality.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
          </div>
        </div>
      </div>

      <!-- Medical History -->
      <div class="card mb-4">
        <div class="card-header bg-light">
          <h3 class="h5 mb-0">Medical History</h3>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-4 form-check">
              <input type="checkbox" name="{{ form.family_history_alzheimers.html_name }}" id="{{ form.family_history_alzheimers.id_for_label }}" class="form-check-input {% if form.family_history_alzheimers.errors %}is-invalid{% endif %}" {% if form.family_history_alzheimers.value %}checked{% endif %}>
              <label class="form-check-label" for="{{ form.family_history_alzheimers.id_for_label }}">Family History of Alzheimer's</label>
              {% for err in form.family_history_alzheimers.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
            <div class="col-md-4 form-check">
              <input type="checkbox" name="{{ form.cardiovascular_disease.html_name }}" id="{{ form.cardiovascular_disease.id_for_label }}" class="form-check-input {% if form.cardiovascular_disease.errors %}is-invalid{% endif %}" {% if form.cardiovascular_disease.value %}checked{% endif %}>
              <label class="form-check-label" for="{{ form.cardiovascular_disease.id_for_label }}">Cardiovascular Disease</label>
              {% for err in form.cardiovascular_disease.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
            <div class="col-md-4 form-check">
              <input type="checkbox" name="{{ form.diabetes.html_name }}" id="{{ form.diabetes.id_for_label }}" class="form-check-input {% if form.diabetes.errors %}is-invalid{% endif %}" {% if form.diabetes.value %}checked{% endif %}>
              <label class="form-check-label" for="{{ form.diabetes.id_for_label }}">Diabetes</label>
              {% for err in form.diabetes.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
          </div>
          <div class="row mt-3">
            <div class="col-md-4 form-check">
              <input type="checkbox" name="{{ form.depression.html_name }}" id="{{ form.depression.id_for_label }}" class="form-check-input {% if form.depression.errors %}is-invalid{% endif %}" {% if form.depression.value %}checked{% endif %}>
              <label class="form-check-label" for="{{ form.depression.id_for_label }}">Depression</label>
              {% for err in form.depression.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
            <div class="col-md-4 form-check">
              <input type="checkbox" name="{{ form.head_injury.html_name }}" id="{{ form.head_injury.id_for_label }}" class="form-check-input {% if form.head_injury.errors %}is-invalid{% endif %}" {% if form.head_injury.value %}checked{% endif %}>
              <label class="form-check-label" for="{{ form.head_injury.id_for_label }}">History of Head Injury</label>
              {% for err in form.head_injury.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
            <div class="col-md-4 form-check">
              <input type="checkbox" name="{{ form.hypertension.html_name }}" id="{{ form.hypertension.id_for_label }}" class="form-check-input {% if form.hypertension.errors %}is-invalid{% endif %}" {% if form.hypertension.value %}checked{% endif %}>
              <label class="form-check-label" for="{{ form.hypertension.id_for_label }}">Hypertension</label>
              {% for err in form.hypertension.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
          </div>
        </div>
      </div>

      <!-- Clinical Measurements -->
      <div class="card mb-4">
        <div class="card-header bg-light">
          <h3 class="h5 mb-0">Clinical Measurements</h3>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-3 form-group">
              <label for="{{ form.systolic_bp.id_for_label }}">Systolic BP (mmHg) <span class="required-indicator">*</span></label>
              <input type="number" name="{{ form.systolic_bp.html_name }}" id="{{ form.systolic_bp.id_for_label }}" class="form-control {% if form.systolic_bp.errors %}is-invalid{% endif %}" value="{{ form.systolic_bp.value|default:'' }}" min="70" max="250" required>
              {% for err in form.systolic_bp.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
            <div class="col-md-3 form-group">
              <label for="{{ form.diastolic_bp.id_for_label }}">Diastolic BP (mmHg) <span class="required-indicator">*</span></label>
              <input type="number" name="{{ form.diastolic_bp.html_name }}" id="{{ form.diastolic_bp.id_for_label }}" class="form-control {% if form.diastolic_bp.errors %}is-invalid{% endif %}" value="{{ form.diastolic_bp.value|default:'' }}" min="40" max="150" required>
              {% for err in form.diastolic_bp.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
          </div>
          <div class="row mt-3">
            <div class="col-md-3 form-group">
              <label for="{{ form.cholesterol_total.id_for_label }}">Total Cholesterol (mg/dL) <span class="required-indicator">*</span></label>
              <input type="number" name="{{ form.cholesterol_total.html_name }}" id="{{ form.cholesterol_total.id_for_label }}" class="form-control {% if form.cholesterol_total.errors %}is-invalid{% endif %}" value="{{ form.cholesterol_total.value|default:'' }}" min="100" max="500" required>
              {% for err in form.cholesterol_total.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
            <div class="col-md-3 form-group">
              <label for="{{ form.cholesterol_ldl.id_for_label }}">LDL Cholesterol (mg/dL) <span class="required-indicator">*</span></label>
              <input type="number" name="{{ form.cholesterol_ldl.html_name }}" id="{{ form.cholesterol_ldl.id_for_label }}" class="form-control {% if form.cholesterol_ldl.errors %}is-invalid{% endif %}" value="{{ form.cholesterol_ldl.value|default:'' }}" min="30" max="300" required>
              {% for err in form.cholesterol_ldl.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
            <div class="col-md-3 form-group">
              <label for="{{ form.cholesterol_hdl.id_for_label }}">HDL Cholesterol (mg/dL) <span class="required-indicator">*</span></label>
              <input type="number" name="{{ form.cholesterol_hdl.html_name }}" id="{{ form.cholesterol_hdl.id_for_label }}" class="form-control {% if form.cholesterol_hdl.errors %}is-invalid{% endif %}" value="{{ form.cholesterol_hdl.value|default:'' }}" min="20" max="100" required>
              {% for err in form.cholesterol_hdl.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
            <div class="col-md-3 form-group">
              <label for="{{ form.cholesterol_triglycerides.id_for_label }}">Triglycerides (mg/dL) <span class="required-indicator">*</span></label>
              <input type="number" name="{{ form.cholesterol_triglycerides.html_name }}" id="{{ form.cholesterol_triglycerides.id_for_label }}" class="form-control {% if form.cholesterol_triglycerides.errors %}is-invalid{% endif %}" value="{{ form.cholesterol_triglycerides.value|default:'' }}" min="50" max="500" required>
              {% for err in form.cholesterol_triglycerides.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
          </div>
        </div>
      </div>

      <!-- Cognitive Assessment -->
      <div class="card mb-4">
        <div class="card-header bg-light">
          <h3 class="h5 mb-0">Cognitive Assessment</h3>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-4 form-group">
              <label for="{{ form.mmse.id_for_label }}">MMSE Score <span class="required-indicator">*</span></label>
              <input type="number" name="{{ form.mmse.html_name }}" id="{{ form.mmse.id_for_label }}" class="form-control {% if form.mmse.errors %}is-invalid{% endif %}" value="{{ form.mmse.value|default:'' }}" min="0" max="30" required>
              {% for err in form.mmse.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
              <div class="field-help">Mini-Mental State Examination score (0-30)</div>
            </div>
            <div class="col-md-4 form-group">
              <label for="{{ form.functional_assessment.id_for_label }}">Functional Assessment Score <span class="required-indicator">*</span></label>
              <input type="number" name="{{ form.functional_assessment.html_name }}" id="{{ form.functional_assessment.id_for_label }}" class="form-control {% if form.functional_assessment.errors %}is-invalid{% endif %}" value="{{ form.functional_assessment.value|default:'' }}" min="0" max="100" required>
              {% for err in form.functional_assessment.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
              <div class="field-help">Higher scores indicate better functioning</div>
            </div>
            <div class="col-md-4 form-group">
              <label for="{{ form.adl.id_for_label }}">ADL Score <span class="required-indicator">*</span></label>
              <input type="number" name="{{ form.adl.html_name }}" id="{{ form.adl.id_for_label }}" class="form-control {% if form.adl.errors %}is-invalid{% endif %}" value="{{ form.adl.value|default:'' }}" min="0" max="100" required>
              {% for err in form.adl.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
              <div class="field-help">Activities of Daily Living score</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Symptoms & Behaviors -->
      <div class="card mb-4">
        <div class="card-header bg-light">
          <h3 class="h5 mb-0">Symptoms & Behaviors</h3>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-4 form-check">
              <input type="checkbox" name="{{ form.memory_complaints.html_name }}" id="{{ form.memory_complaints.id_for_label }}" class="form-check-input {% if form.memory_complaints.errors %}is-invalid{% endif %}" {% if form.memory_complaints.value %}checked{% endif %}>
              <label class="form-check-label" for="{{ form.memory_complaints.id_for_label }}">Memory Complaints</label>
              {% for err in form.memory_complaints.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
            <div class="col-md-4 form-check">
              <input type="checkbox" name="{{ form.behavioral_problems.html_name }}" id="{{ form.behavioral_problems.id_for_label }}" class="form-check-input {% if form.behavioral_problems.errors %}is-invalid{% endif %}" {% if form.behavioral_problems.value %}checked{% endif %}>
              <label class="form-check-label" for="{{ form.behavioral_problems.id_for_label }}">Behavioral Problems</label>
              {% for err in form.behavioral_problems.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
            <div class="col-md-4 form-check">
              <input type="checkbox" name="{{ form.confusion.html_name }}" id="{{ form.confusion.id_for_label }}" class="form-check-input {% if form.confusion.errors %}is-invalid{% endif %}" {% if form.confusion.value %}checked{% endif %}>
              <label class="form-check-label" for="{{ form.confusion.id_for_label }}">Confusion</label>
              {% for err in form.confusion.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
          </div>
          <div class="row mt-3">
            <div class="col-md-4 form-check">
              <input type="checkbox" name="{{ form.disorientation.html_name }}" id="{{ form.disorientation.id_for_label }}" class="form-check-input {% if form.disorientation.errors %}is-invalid{% endif %}" {% if form.disorientation.value %}checked{% endif %}>
              <label class="form-check-label" for="{{ form.disorientation.id_for_label }}">Disorientation</label>
              {% for err in form.disorientation.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
            <div class="col-md-4 form-check">
              <input type="checkbox" name="{{ form.personality_changes.html_name }}" id="{{ form.personality_changes.id_for_label }}" class="form-check-input {% if form.personality_changes.errors %}is-invalid{% endif %}" {% if form.personality_changes.value %}checked{% endif %}>
              <label class="form-check-label" for="{{ form.personality_changes.id_for_label }}">Personality Changes</label>
              {% for err in form.personality_changes.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
            <div class="col-md-4 form-check">
              <input type="checkbox" name="{{ form.difficulty_completing_tasks.html_name }}" id="{{ form.difficulty_completing_tasks.id_for_label }}" class="form-check-input {% if form.difficulty_completing_tasks.errors %}is-invalid{% endif %}" {% if form.difficulty_completing_tasks.value %}checked{% endif %}>
              <label class="form-check-label" for="{{ form.difficulty_completing_tasks.id_for_label }}">Difficulty Completing Tasks</label>
              {% for err in form.difficulty_completing_tasks.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
          </div>
          <div class="row mt-3">
            <div class="col-md-4 form-check">
              <input type="checkbox" name="{{ form.forgetfulness.html_name }}" id="{{ form.forgetfulness.id_for_label }}" class="form-check-input {% if form.forgetfulness.errors %}is-invalid{% endif %}" {% if form.forgetfulness.value %}checked{% endif %}>
              <label class="form-check-label" for="{{ form.forgetfulness.id_for_label }}">Forgetfulness</label>
              {% for err in form.forgetfulness.errors %}<div class="invalid-feedback">{{ err }}</div>{% endfor %}
            </div>
          </div>
        </div>
      </div>

      <div class="text-center mt-4 mb-5">
        <button type="submit" class="btn btn-primary btn-lg">Generate Risk Assessment</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}